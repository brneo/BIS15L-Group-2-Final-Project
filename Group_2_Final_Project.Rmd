---
title: "group2covidfoodproject"
author: “Mildred Hernandez, Brian Rezende, Margarita Ibarra, Byron Corado”
date: "`r Sys.Date()`"
output: 
  html_document: 
    keep_md: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(janitor)
library(here)
options(scipen=999) #disables scientific notation when printing
```

###Loading the Data
```{r}
food_supply <- readr::read_csv("data/Food_Supply_Quantity_kg_Data.csv")
```
###Cleaning the Data
```{r}
food_supply_clean <- janitor::clean_names(food_supply)
food_supply_clean
```
###Viewing the Data
```{r}
glimpse(food_supply_clean)
```
```{r}
summary(food_supply_clean)
```

```{r}
food_supply_clean %>%
  naniar::miss_var_summary()
```
###Analysis
```{r}
food_supply_clean %>%
  select(country, deaths, population) %>%
  arrange(desc(deaths)) %>% 
  head(n=3)
```
```{r}
food_supply_clean %>%
  select(country, deaths, population) %>%
  arrange((deaths)) %>% 
  head(n=3)
```

***Total Protein Consumption by Country, Focusing on those with the Three HIGHEST Death Percentages**
```{r}
food_supply_clean %>%
  filter(country=="Belgium"| country=="Slovenia"| country=="United Kingdom") %>%
  group_by(country, deaths, population) %>%
  summarize(total_protein_consumption = sum(animal_fats, animal_products, aquatic_products_other, eggs, fish_seafood, meat, milk_excluding_butter, offals))%>%
  arrange(desc(total_protein_consumption))
```

***Total Protein Consumption by Country, Focusing on those with the Three LOWEST Death Percentages**
```{r}
food_supply_clean %>%
  filter(country=="Cambodia"| country=="Dominica"| country=="Lao People's Democratic Republic") %>%
  group_by(country, deaths, population) %>%
  summarize(total_protein_consumption = sum(animal_fats, animal_products, aquatic_products_other, eggs, fish_seafood, meat, milk_excluding_butter, offals)) %>%
  arrange(-desc(total_protein_consumption))
```
***Total Protein Consumption by Country, Focusing on those with the United States' Death Percentages***
```{r}
food_supply_clean %>%
  filter(country=="United States of America") %>%
  group_by(country, deaths, population) %>%
  summarize(total_protein_consumption = sum(animal_fats, animal_products, aquatic_products_other, eggs, fish_seafood, meat, milk_excluding_butter, offals))
```

```{r}
protein_graph<-food_supply_clean %>%
  filter(country=="Belgium"| country=="Slovenia"| country=="United Kingdom"|country=="Cambodia"| country=="Dominica"| country=="Lao People's Democratic Republic"|country=="United States of America") %>%
  group_by(country) %>%
  summarize(total_protein_consumption = sum(animal_fats, animal_products, aquatic_products_other, eggs, fish_seafood, meat, milk_excluding_butter, offals)) %>%
  ggplot(aes(x=country, y=total_protein_consumption))+
  geom_col()+
  labs(title = "Total Protein Consumption by Country (%)",
       x="Country",
       y="Protein Consumption")+
  theme(plot.title=element_text(hjust=0.5), axis.text.x = element_text(angle = 45, hjust=1))
protein_graph
```
higher protein because it's a bigger country...

***Total Grain Consumption by Country, Focusing on those with the Three HIGHEST Death Percentages***
```{r}
grains_highest <-food_supply_clean %>%
  group_by(country, deaths, population) %>%
  filter( country == "United Kingdom"| country == "Slovenia" | country == "Belgium"  ) %>% 
  summarize(total_grain_consumption = sum(alcoholic_beverages, cereals_excluding_beer, oilcrops, pulses, spices))
grains_highest
```
***Total Grain Consumption by Country, Focusing on those with the Three LOWEST Death Percentages***
```{r}
grains_lowest <-food_supply_clean %>%
  group_by(country, deaths, population) %>%
  filter( country == "Cambodia"| country == "Dominica" | country == "Lao People's Democratic Republic") %>% 
  summarize(total_grain_consumption = sum(alcoholic_beverages, cereals_excluding_beer, oilcrops, pulses, spices))
grains_lowest
```
***Total Protein Consumption by Country, Focusing on those with the United States' Death Percentages***
```{r}
grains_us <-food_supply_clean %>%
  group_by(country, deaths, population) %>%
  filter( country == "United States of America") %>% 
  summarize(total_grain_consumption = sum(alcoholic_beverages, cereals_excluding_beer, oilcrops, pulses, spices))
grains_us
```

```{r}
grains_graph <-food_supply_clean %>%
  group_by(country) %>%
  filter( country == "Cambodia"| country == "Dominica" | country == "Lao People's Democratic Republic" | country == "United Kingdom"| country == "Slovenia" | country == "Belgium" | country == "United States of America") %>% 
  summarize(total_grain_consumption = sum(alcoholic_beverages, cereals_excluding_beer, oilcrops, pulses, spices)) %>% 
  ggplot(aes(x = country, y =total_grain_consumption)) + geom_col() +
  labs(title = "Total Grain Consumption by Country (%)",
       x="Country",
       y="Grain Consumption")+
  theme(plot.title=element_text(hjust=0.5), axis.text.x = element_text(angle = 45, hjust=1))
grains_graph
```

***Total Fruit Consumption by Country, Focusing on those with the Three HIGHEST Death Percentages***
```{r}
fruits_highest<-food_supply_clean %>%
  filter(country=="Belgium"| country=="Slovenia"| country=="United Kingdom") %>%
  group_by(country, deaths, population) %>%
  summarize(total_fruit_consumption = sum(fruits_excluding_wine, stimulants),.groups = 'keep') %>%
  arrange(desc(deaths))
fruits_highest
```

***Total Fruit Consumption by Country, Focusing on those with the Three LOWEST Death Percentages***
```{r}
fruits_lowest<-food_supply_clean %>%
  filter(country=="Cambodia"| country=="Dominica"| country=="Lao People's Democratic Republic") %>%
  group_by(country, deaths, population) %>%
  summarize(total_fruit_consumption = sum(fruits_excluding_wine, stimulants),.groups = 'keep') %>%
  arrange(desc(deaths))
fruits_lowest
```

***Total Fruit Consumption by Country, Focusing on those with the United States' Death Percentages***
```{r}
fruits_us<-food_supply_clean %>%
  filter(country=="United States of America") %>%
  group_by(country, deaths, population) %>%
  summarize(total_fruit_consumption = sum(fruits_excluding_wine, stimulants),
            .groups = 'keep')
fruits_us
```

##Fruit Consumption Table
```{r}
fruits_graph<-food_supply_clean %>%
  filter(country=="Cambodia"| country=="Dominica"| country=="Lao People's Democratic Republic"| country=="United States of America" | country=="Belgium"| country=="Slovenia"| country=="United Kingdom") %>%
  group_by(country) %>%
  summarize(total_fruit_consumption = sum(fruits_excluding_wine, stimulants),.groups = 'keep') %>%
  ggplot(aes(x=reorder(country, total_fruit_consumption), y=total_fruit_consumption, fill=country))+
  geom_col()+
  coord_flip()+
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank())+
  labs(title = "Percentage of Fruit Intake by Country (%)",
       x=NULL,
       y="Fruit Consumption",
       fill = "country")
fruits_graph
```
#works outside of the "theme" xlab(“”)
***Total Veggies Consumption by Country, Focusing on those with the Three HIGHEST Death Percentages***
```{r}
veggies_highest <-food_supply_clean %>%
  group_by(country, deaths, population) %>%
  filter(country == "Belgium" | country == "Slovenia" | country == "United Kingdom") %>% 
  summarise(total_veggie_consumption = sum(starchy_roots, sugar_crops, sugar_sweeteners, treenuts, vegetable_oils, vegetables, vegetal_products))
veggies_highest
```
***Total Veggies Consumption by Country, Focusing on those with the Three HIGHEST Death Percentages***
```{r}
veggies_lowest <-food_supply_clean %>%
  group_by(country, deaths, population) %>%
  filter(country == "Cambodia" | country == "Dominica" | country == "Lao People's Democratic Republic") %>% 
  summarise(total_veggie_consumption = sum(starchy_roots, sugar_crops, sugar_sweeteners, treenuts, vegetable_oils, vegetables, vegetal_products))
veggies_lowest
```
***Total Veggies Consumption by Country, Focusing on those with the United States' Death Percentages***
```{r}
veggies_us <-food_supply_clean %>%
  group_by(country, deaths, population) %>%
  filter(country == "United States of America") %>% 
  summarise(total_veggie_consumption = sum(starchy_roots, sugar_crops, sugar_sweeteners, treenuts, vegetable_oils, vegetables, vegetal_products))
veggies_us
```

```{r}
veggies_graph <-food_supply_clean %>%
  group_by(country) %>%
  filter( country == "Cambodia"| country == "Dominica" | country == "Lao People's Democratic Republic" | country == "United Kingdom"| country == "Slovenia" | country == "Belgium" | country == "United States of America") %>%
  summarise(veggie_totals = sum(starchy_roots, sugar_crops, sugar_sweeteners, treenuts, vegetable_oils, vegetables, vegetal_products)) %>% 
  ggplot(aes(x=country, y=veggie_totals))+
  geom_col()+
  labs(title = "Total Vegetable Consumption by Country (%)",
       x="Country",
       y="Vegetable Consumption")+
    theme(plot.title=element_text(hjust=0.5), axis.text.x = element_text(angle = 45, hjust=1))
veggies_graph
```
#mutate each country to fill by letter given to the countries (3 lowest countries will be A and 3 highest countries will be B) or gradient based on value of y axis
***Total Category Consumption of Each Country***
```{r}
total_food_consumption<-food_supply_clean %>%
  filter(country=="Belgium"| country=="Slovenia"| country=="United Kingdom"|country=="Cambodia"| country=="Dominica"| country=="Lao People's Democratic Republic"|country=="United States of America") %>%
  select(country:obesity, deaths) %>%
  group_by(country, deaths) %>%
  summarize(total_protein_consumption = sum(animal_fats, animal_products, aquatic_products_other, eggs, fish_seafood, meat, milk_excluding_butter, offals),
            total_veggie_consumption = sum(starchy_roots, sugar_crops, sugar_sweeteners, treenuts, vegetable_oils, vegetables, vegetal_products),
            total_fruit_consumption = sum(fruits_excluding_wine, stimulants),
            total_grain_consumption = sum(alcoholic_beverages, cereals_excluding_beer, oilcrops, pulses, spices)) %>% 
  arrange(desc(deaths))
total_food_consumption
```



***Total Category Consumption of United States***
```{r}
food_supply_clean %>%
  filter(country=="United States of America") %>%
  group_by(country, deaths, population) %>%
  summarize(total_protein_consumption = sum(animal_fats, animal_products, aquatic_products_other, eggs, fish_seafood, meat, milk_excluding_butter, offals),
            total_veggie_consumption = sum(starchy_roots, sugar_crops, sugar_sweeteners, treenuts, vegetable_oils, vegetables, vegetal_products),
            total_fruit_consumption = sum(fruits_excluding_wine, stimulants),
            total_grain_consumption = sum(alcoholic_beverages, cereals_excluding_beer, oilcrops, pulses, spices),
            .groups = 'keep') %>%
  arrange(desc(deaths))
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
